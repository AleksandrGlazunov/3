# Прогнозирование оттока клиентов
## Описание проекта

Из банка стали уходить клиенты. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.

Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Предоставлены исторические данные о поведении клиентов и расторжении договоров с банком.

Важный аспект данного проекта: продолжение исследования работы некоторых классификаторов, начатое в `05_project`, и исследование метрик классификации.
## Цель

1. Исследовать поведение метрик `точность`, `полнота`, `f1-score` и `ROC-AUC`, изменяя порог разделения классов.
2. Построить модель с максимально большим значением `f1` для прогнозирования ухода клиентов.

## Исследование

В **Подготовке к работе** загружены нужные библиотеки, заданы значения параметров и описаны функции.

**Открытие, изучение и подготовка данных** выявили незначительные недостатки и пропуски, которые были устранены. Выявлен дисбаланс данных по целевому классу. Категориальные признаки преобразованы с помощью `OneHotEncoder`.  Так же на этом этапе датасет разбит на обучающие признаки и целевой признак, затем на тренировочную, валидационную и тестовые выборки в соотношении 3:1:1. Выделены отдельные датасеты с обучающими признаками, приведёнными к одному диапазону значений с помощью `StandardScaler`.

В ходе **Исследования моделей** были рассмотрены классификаторы `LogisiticRegression`, `DecisionTreeClassifier` и `RandomForestClassifier`. Изучено поведение метрик `точность`, `полнота`, `f1-score` и `ROC-AUC` в зависимости от порога разделения классов. Лучшей моделью признан `RandomForestClassifier` с гиперпараметрами `class_weight='balanced'`,  `n_estimators=51`,  `max_depth=9` и `f1_score` **0.622**. Показано, что изменением порога до `0.4` можно увеличить `полноту` предсказания *ухода клиента*. Модель будет распознавать больше клиентов, которые действительно *хотят уйти*, но при этом увеличится количество *ложноположительных* предсказаний.

В разделе **SMOTE** рассмотрен дополнительный метод борьбы с дисбалансом.

Проведено **Тестирование лучшей модели**.

В **Выводе** описаны закономерности, выявленные в ходе исследования

## Навыки и инструменты

`pandas`, `matplotlib`, `seaborn`,  `sklearn`, `LogisticRegression`, `DecisionTreeClassifier`, `RandomForestClassifier`
